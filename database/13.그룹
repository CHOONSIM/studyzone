/* 
Group 그룹
    - 어떤 기준을 두고 해당 기준에 따라 집합으로 구분하여 결과를 표시
    - 00별 이라고 할 경우 모두 그룹에 해당
    - 집계 함수
*/

SELECT*FROM PRODUCT;

-- 분류별 000를 조회
SELECT TYPE FROM PRODUCT;

SELECT TYPE,SUM(PRICE) 합계 FROM PRODUCT GROUP BY TYPE;
SELECT TYPE,AVG(PRICE) 평균 FROM PRODUCT GROUP BY TYPE;
SELECT TYPE,MAX(PRICE) 최대 FROM PRODUCT GROUP BY TYPE;
SELECT TYPE,MIN(PRICE) 최소 FROM PRODUCT GROUP BY TYPE;
SELECT TYPE,COUNT(*) 갯수 FROM PRODUCT GROUP BY TYPE;

SELECT TYPE,SUM(PRICE) 합계 FROM PRODUCT GROUP BY TYPE ORDER BY 합계 DESC;

-- 참고 : 중복제거
SELECT DISTINCT TYPE FROM PRODUCT;

-- 연도별 제품 개수를 출력
-- 1
SELECT EXTRACT(YEAR FROM MADE) FROM PRODUCT;
-- 2
SELECT EXTRACT(YEAR FROM MADE)연도 FROM PRODUCT GROUP BY EXTRACT(YEAR FROM MADE);
-- 3
SELECT EXTRACT(YEAR FROM MADE)연도,
COUNT(*)개수,
SUM(PRICE),
AVG(PRICE),
MAX(PRICE),
MIN(PRICE)
FROM PRODUCT 
GROUP BY EXTRACT(YEAR FROM MADE);

-- 등급별 회원 수를 출력
SELECT MEMBER_LEVEL,
COUNT(*),
SUM(MEMBER_POINT),
AVG(MEMBER_POINT),
MAX(MEMBER_POINT),
MIN(MEMBER_POINT)
FROM MEMBER GROUP BY MEMBER_LEVEL;

-- 그룹 HAVING 키워드로 조건을 사용할 수 있다 (그룹 성립 조건이므로 WHERE와 다름)
SELECT TYPE FROM PRODUCT GROUP BY TYPE;
SELECT TYPE FROM PRODUCT GROUP BY TYPE HAVING COUNT(*)>3;

-- 그룹이 여러 항목일 경우에는 조회항목과 그룹에 각각 전부 작성하면 된다.
SELECT EXTRACT(YEAR FROM MADE) 연도, TYPE 분류, COUNT(*) 개수 FROM PRODUCT 
GROUP BY EXTRACT(YEAR FROM MADE), TYPE
ORDER BY 연도 ASC, 개수 ASC;