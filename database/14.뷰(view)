-- 뷰(VIEW) : 자주 사용하는 조회구문을 테이블화 시키는 도구
-- 논리 테이블 혹은 가상 테이블이라고 부름
-- 조회만 하고 등록, 수정 삭제는 가급적 지양한다
CREATE VIEW POCKETMON_STAT AS
SELECT TYPE, COUNT(*) CNT FROM POCKETMON GROUP BY TYPE     -- 자바에서 뽑을때 GET.CNT
ORDER BY CNT DESC, TYPE ASC;

SELECT*FROM POCKETMON_STAT;

-- subject 통계 view
CREATE VIEW SUBJECT_STAT AS
SELECT TYPE,
COUNT(*) CNT, 
AVG(PRICE) AVG 
FROM SUBJECT GROUP BY TYPE;

SELECT*FROM SUBJECT_STAT ORDER BY CNT DESC, AVG DESC;
DROP VIEW SUBJECT_STAT;

-- member 통계
CREATE VIEW MEMBER_STAT AS
SELECT 
MEMBER_LEVEL,
COUNT(*)CNT,
SUM(MEMBER_POINT) TOTAL,
AVG(MEMBER_POINT) AVG,
MAX(MEMBER_POINT) MAX,
MIN(MEMBER_POINT) MIN
FROM MEMBER GROUP BY MEMBER_LEVEL;
SELECT*FROM MEMBER_STAT ORDER BY MEMBER_LEVEL ASC;

SELECT*FROM MEMBER_STAT ORDER BY CNT ASC;
SELECT*FROM MEMBER_STAT ORDER BY CNT DESC;
SELECT*FROM MEMBER_STAT ORDER BY TOTAL ASC;
SELECT*FROM MEMBER_STAT ORDER BY TOTAL DESC;

COMMIT;